import React from "react";
import { useState } from "react";
import { Link, useHistory } from "react-router-dom";
import { useQuery } from "react-query";
import axios from "axios";

import { Form } from "./Login/Form";
import { config } from "../utils/config";

import headerLogo from "../assets/img/logo.svg";

export const Header = () => {
    const [showModal, setShowModal] = useState(false);
    const history = useHistory();

    const openModal = () => {
        setShowModal((prev) => !prev);
    };

    const { data } = useQuery("me", () =>
        axios.get(`${config.SERVER_URL}/api/user/me`)
    );
    return (
        <div className="header">
            <div className="container">
                <div className="header__inner">
                    <div className="header__item">
                        <Link to="/">
                            <div className="header__logo">
                                <img src={headerLogo} alt="" />
                            </div>
                        </Link>

                        <nav className="header__menu">
                            <ul>
                                <Link to="/" className="header__link">
                                    <li>
                                        <span>Catalog</span>
                                    </li>
                                </Link>
                                <Link to="/delivery" className="header__link">
                                    <li>
                                        <span>Shipping</span>
                                    </li>
                                </Link>
                                <Link to="/payment" className="header__link">
                                    <li>
                                        <span>Payment</span>
                                    </li>
                                </Link>
                                <Link to="/contacts" className="header__link">
                                    <li>
                                        <span>Contacts</span>
                                    </li>
                                </Link>
                            </ul>
                        </nav>
                    </div>
                    <div className="header__item">
                        <div className="header__phone">
                            <svg
                                width="17"
                                height="17"
                                viewBox="0 0 17 17"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                            >
                                <mask
                                    id="mask0"
                                    mask-type="alpha"
                                    maskUnits="userSpaceOnUse"
                                    x="1"
                                    y="1"
                                    width="15"
                                    height="15"
                                >
                                    <path
                                        fillRule="evenodd"
                                        clipRule="evenodd"
                                        d="M4.67435 2.83341C3.6586 2.83341 2.83268 3.65933 2.83268 4.67508C2.83268 9.90825 7.09047 14.1667 12.3243 14.1667C13.3394 14.1667 14.166 13.3408 14.166 12.3251C14.166 12.2465 14.1611 12.1692 14.1511 12.0927L10.8786 11.3419C10.8135 11.4666 10.7419 11.6019 10.6768 11.728C10.3538 12.3442 10.12 12.7919 9.5236 12.5517C7.18185 11.7301 5.27006 9.81758 4.43777 7.4475C4.18489 6.89146 4.66656 6.63929 5.27714 6.32054C5.4011 6.25537 5.53497 6.18525 5.65752 6.1215L4.90668 2.84829C4.82806 2.83837 4.75156 2.83341 4.67435 2.83341ZM12.3243 15.5834C6.30918 15.5834 1.41602 10.6902 1.41602 4.67508C1.41602 2.87804 2.87731 1.41675 4.67435 1.41675C4.85852 1.41675 5.04056 1.43233 5.21693 1.46279C5.38906 1.49041 5.56189 1.53433 5.73047 1.59241C5.96068 1.67246 6.13422 1.86583 6.18877 2.10383L7.15847 6.32833C7.21231 6.56067 7.14502 6.80433 6.97927 6.97716C6.88293 7.07775 6.88081 7.07987 6.00247 7.53958C6.71364 9.0795 7.94968 10.3113 9.45843 10.9984C9.91885 10.1193 9.92168 10.1165 10.0223 10.0202C10.1951 9.85441 10.4402 9.78996 10.6711 9.84096L14.8963 10.8107C15.1336 10.8652 15.327 11.038 15.4063 11.2682C15.4644 11.4354 15.5083 11.6082 15.5374 11.786C15.5671 11.961 15.5827 12.1423 15.5827 12.3251C15.5827 14.1221 14.1207 15.5834 12.3243 15.5834Z"
                                        fill="white"
                                    />
                                </mask>
                                <g mask="url(#mask0)">
                                    <rect
                                        width="17"
                                        height="17"
                                        fill="#FE5F1E"
                                    />
                                </g>
                            </svg>

                            <span>+ 1-888-866-6948</span>
                        </div>
                        <button
                            onClick={
                                data?.data?.user
                                    ? () => {
                                          history.push("/profile");
                                      }
                                    : openModal
                            }
                            className="header__user"
                        >
                            <svg
                                width="31"
                                height="31"
                                viewBox="0 0 31 31"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                            >
                                <path
                                    fillRule="evenodd"
                                    clipRule="evenodd"
                                    d="M18.0839 9.04172C18.0839 7.61701 16.9253 6.45839 15.5006 6.45839C14.0759 6.45839 12.9173 7.61701 12.9173 9.04172C12.9173 10.4664 14.0759 11.6251 15.5006 11.6251C16.9253 11.6251 18.0839 10.4664 18.0839 9.04172ZM20.6673 9.04167C20.6673 11.8911 18.3501 14.2083 15.5007 14.2083C12.6512 14.2083 10.334 11.8911 10.334 9.04167C10.334 6.19225 12.6512 3.875 15.5007 3.875C18.3501 3.875 20.6673 6.19225 20.6673 9.04167ZM6.45898 25.8333C6.45898 20.8474 10.5161 16.7916 15.5007 16.7916C20.4852 16.7916 24.5423 20.8474 24.5423 25.8333C24.5423 26.5463 23.9649 27.1249 23.2507 27.1249C22.5364 27.1249 21.959 26.5463 21.959 25.8333C21.959 22.2722 19.0618 19.3749 15.5007 19.3749C11.9395 19.3749 9.04232 22.2722 9.04232 25.8333C9.04232 26.5463 8.46494 27.1249 7.75065 27.1249C7.03636 27.1249 6.45898 26.5463 6.45898 25.8333Z"
                                    fill="#fe5f1e"
                                />
                                <mask
                                    id="mask0"
                                    mask-type="alpha"
                                    maskUnits="userSpaceOnUse"
                                    x="6"
                                    y="3"
                                    width="19"
                                    height="25"
                                >
                                    <path
                                        fillRule="evenodd"
                                        clipRule="evenodd"
                                        d="M18.0839 9.04172C18.0839 7.61701 16.9253 6.45839 15.5006 6.45839C14.0759 6.45839 12.9173 7.61701 12.9173 9.04172C12.9173 10.4664 14.0759 11.6251 15.5006 11.6251C16.9253 11.6251 18.0839 10.4664 18.0839 9.04172ZM20.6673 9.04167C20.6673 11.8911 18.3501 14.2083 15.5007 14.2083C12.6512 14.2083 10.334 11.8911 10.334 9.04167C10.334 6.19225 12.6512 3.875 15.5007 3.875C18.3501 3.875 20.6673 6.19225 20.6673 9.04167ZM6.45898 25.8333C6.45898 20.8474 10.5161 16.7916 15.5007 16.7916C20.4852 16.7916 24.5423 20.8474 24.5423 25.8333C24.5423 26.5463 23.9649 27.1249 23.2507 27.1249C22.5364 27.1249 21.959 26.5463 21.959 25.8333C21.959 22.2722 19.0618 19.3749 15.5007 19.3749C11.9395 19.3749 9.04232 22.2722 9.04232 25.8333C9.04232 26.5463 8.46494 27.1249 7.75065 27.1249C7.03636 27.1249 6.45898 26.5463 6.45898 25.8333Z"
                                        fill="white"
                                    />
                                </mask>
                            </svg>
                        </button>
                        <Form
                            showModal={showModal}
                            setShowModal={setShowModal}
                        />

                        <Link to="/cart">
                            <div className="header__cart">
                                <svg
                                    width="32"
                                    height="31"
                                    viewBox="0 0 32 31"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg"
                                >
                                    <path
                                        fillRule="evenodd"
                                        clipRule="evenodd"
                                        d="M21.912 18.0165H12.0721L9.95761 10.2951H25.787L21.912 18.0165ZM27.9829 8.94126C27.5088 8.17684 26.6873 7.72128 25.7857 7.72128H9.2524L8.45544 4.80904C8.30173 4.24924 7.79153 3.8606 7.20898 3.8606H4.62565C3.91136 3.8606 3.33398 4.43712 3.33398 5.14749C3.33398 5.85786 3.91136 6.43439 4.62565 6.43439H6.22215L9.83753 19.6418C9.99124 20.2016 10.5014 20.5902 11.084 20.5902H22.709C23.1985 20.5902 23.6454 20.3148 23.865 19.8786L28.0965 11.4456C28.5008 10.6412 28.4569 9.70567 27.9829 8.94126ZM10.4384 23.164C9.36893 23.164 8.50093 24.0275 8.50093 25.0944C8.50093 26.1612 9.36893 27.0247 10.4384 27.0247C11.5079 27.0247 12.3759 26.1612 12.3759 25.0944C12.3759 24.0275 11.5079 23.164 10.4384 23.164ZM21.4176 25.0944C21.4176 24.0275 22.2856 23.164 23.3551 23.164C24.4246 23.164 25.2926 24.0275 25.2926 25.0944C25.2926 26.1612 24.4246 27.0247 23.3551 27.0247C22.2856 27.0247 21.4176 26.1612 21.4176 25.0944Z"
                                        fill="#fe5f1e"
                                    />
                                    <mask
                                        id="mask0"
                                        mask-type="alpha"
                                        maskUnits="userSpaceOnUse"
                                        x="3"
                                        y="3"
                                        width="26"
                                        height="25"
                                    >
                                        <path
                                            fillRule="evenodd"
                                            clipRule="evenodd"
                                            d="M21.912 18.0165H12.0721L9.95761 10.2951H25.787L21.912 18.0165ZM27.9829 8.94126C27.5088 8.17684 26.6873 7.72128 25.7857 7.72128H9.2524L8.45544 4.80904C8.30173 4.24924 7.79153 3.8606 7.20898 3.8606H4.62565C3.91136 3.8606 3.33398 4.43712 3.33398 5.14749C3.33398 5.85786 3.91136 6.43439 4.62565 6.43439H6.22215L9.83753 19.6418C9.99124 20.2016 10.5014 20.5902 11.084 20.5902H22.709C23.1985 20.5902 23.6454 20.3148 23.865 19.8786L28.0965 11.4456C28.5008 10.6412 28.4569 9.70567 27.9829 8.94126ZM10.4384 23.164C9.36893 23.164 8.50093 24.0275 8.50093 25.0944C8.50093 26.1612 9.36893 27.0247 10.4384 27.0247C11.5079 27.0247 12.3759 26.1612 12.3759 25.0944C12.3759 24.0275 11.5079 23.164 10.4384 23.164ZM21.4176 25.0944C21.4176 24.0275 22.2856 23.164 23.3551 23.164C24.4246 23.164 25.2926 24.0275 25.2926 25.0944C25.2926 26.1612 24.4246 27.0247 23.3551 27.0247C22.2856 27.0247 21.4176 26.1612 21.4176 25.0944Z"
                                            fill="white"
                                        />
                                    </mask>
                                </svg>
                            </div>
                        </Link>
                    </div>
                </div>
            </div>
        </div>
    );
};
